<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="icon" href="/images/Crossfit.jpg">
    <link rel="stylesheet" href="/styles/style.css">
    <link rel="stylesheet" href="/styles/club_enlistpage.css">
    <link rel="stylesheet" href="/styles/club_list_specific.css">
    <link rel="stylesheet" href="/styles/club_dashboard.css">
    <link rel="stylesheet" href="/styles/viewers_dashboard.css">
    <link rel="stylesheet" href="/styles/news.css">
    <link rel="stylesheet" href="/styles/register_viewers.css">
    <link rel="stylesheet" href="/styles/register_clubs.css">
    <link rel="stylesheet" href="/styles/register_leagues.css">
    <link rel="stylesheet" href="/styles/login_viewers.css">
    <link rel="stylesheet" href="/styles/login_clubs.css">
    <link rel="stylesheet" href="/styles/match_setup.css">
    <link rel="stylesheet" href="/styles/update_score.css">
    <link rel="stylesheet" href="/styles/login_leagues.css">
    <link rel="stylesheet" href="/styles/live_score.css">
    <link rel="stylesheet" href="/styles/leader_selection.css">
    <link rel="stylesheet" href="/styles/specific_scorecard.css">
    <link rel="stylesheet" href="/styles/merch.css">
    <link rel="stylesheet" href="/styles/cart.css">
    <link rel="stylesheet" href="/styles/card_game.css">
    <link rel="stylesheet" href="/styles/about.css">
    <link rel="stylesheet" href="/styles/error.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/merch.css">
    <title>Crossfit</title>
    
    <!-- Lottie Player for Animation -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    
    <!-- Crossfit One-Time Loading Screen Styles -->
    <style>
        .crossfit-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #081A26;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.5s ease;
        }

        .crossfit-loader.hidden {
            opacity: 0;
            visibility: hidden;
        }

        /* Prevent body scroll during loading */
        body.crossfit-loading {
            overflow: hidden;
        }
    </style>
</head>

<body class="crossfit-loading">
    <!-- Crossfit One-Time Loading Screen -->
    <div class="crossfit-loader">
        <lottie-player 
            src="/script/animation.json" 
            background="transparent" 
            speed="1" 
            style="width: 100vw; height: 100vh;" 
            loop 
            autoplay>
        </lottie-player>
    </div>
    
    <%- include('../partials/header') %>
        <section class="main-content">
            <%- body %>
        </section>
        <%- include('../partials/footer') %>
            <script src="/script/club_dashboard.js"></script>
            <script src="/script/viewer_dashboard.js"></script>
            <script src="/script/header.js"></script>
            <script src="/script/match_setup.js"></script>
            <script src="/script/update_score.js"></script>
            <script src="/script/live_score.js"></script>
            <script src="/script/specific_scorecard.js"></script>
            <script src="/script/leader_selection.js"></script>
            <script src="/script/club_enlistpage.js"></script>
            <script src="/script/cart.js"></script>
            <script src="/script/merch-filters.js"></script>
            <script src="/script/cart.js"></script>
            <script src="/script/merch-filters.js"></script>
            <script src="/script/card_game.js"></script>
            <script src="/script/cart.js"></script>
            <script src="/script/merch-filters.js"></script>

            <!-- Crossfit One-Time Loading Screen Script -->
            <script>
                (function() {
                    // Check if user has visited before in this session
                    const hasVisitedBefore = sessionStorage.getItem('crossfitVisited');
                    const loaderWrapper = document.querySelector('.crossfit-loader');
                    const body = document.body;

                    // If user has visited before, immediately hide loader
                    if (hasVisitedBefore) {
                        if (loaderWrapper) {
                            loaderWrapper.style.display = 'none';
                        }
                        body.classList.remove('crossfit-loading');
                        return;
                    }

                    // First visit - set the flag
                    sessionStorage.setItem('crossfitVisited', 'true');

                    // Wait for all content to load, then show animation for 3 seconds
                    window.addEventListener('load', function() {
                        setTimeout(function() {
                            if (loaderWrapper) {
                                // Add hidden class to trigger fade-out
                                loaderWrapper.classList.add('hidden');

                                // Listen for transition end to completely remove element
                                loaderWrapper.addEventListener('transitionend', function() {
                                    loaderWrapper.remove();
                                    body.classList.remove('crossfit-loading');
                                }, { once: true });
                            }
                        }, 3000); // 3 seconds as requested
                    });

                    // Fallback: Remove loader after maximum 10 seconds
                    setTimeout(function() {
                        if (loaderWrapper && loaderWrapper.parentNode) {
                            loaderWrapper.remove();
                            body.classList.remove('crossfit-loading');
                        }
                    }, 10000);
                })();
            </script>

</body>

</html>