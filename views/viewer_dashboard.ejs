<div class="viewers-dashboard-main-content">
  <h2>Welcome, <%= user.name %> </h2>

  <!-- Dashboard Summary Cards -->
  <div class="viewers-dashboard-dashboard-cards">

    <!-- Profile Picture -->
    <div class="viewers-dashboard-card">
      <div class="viewers-dashboard-card-header">
        <div class="viewers-dashboard-card-title">Profile Picture</div>
      </div>
      <div class="viewers-dashboard-card-value">
        <% if (user.profile_picture) { %>
        <form action="/dashboard/viewer/add_profile_picture" id="viewers-dashboard-profile-picture-form" method="post" enctype="multipart/form-data">
          <label for="viewers-dashboard-profile-picture-input-1">
            <img src="<%= user.profile_picture %>" alt="Profile Picture" style="width: 80px; border-radius: 50%;">
          </label>
          <input type="file" name="profile_picture" accept="image/*" class="viewers-dashboard-profile-picture-input" id="viewers-dashboard-profile-picture-input-1" required>
          <button>Update Profile Picture</button>
        </form>
        <% } else { %>
        <form action="/dashboard/viewer/add_profile_picture" id="viewers-dashboard-profile-picture-form" method="post" enctype="multipart/form-data">
          <label for="viewers-dashboard-profile-picture-input-2">
            <img src="/images/avatar.png" alt="Profile" style="width: 80px; border-radius: 50%;">
          </label>
          <input type="file" name="profile_picture" accept="image/*" class="viewers-dashboard-profile-picture-input" required id="viewers-dashboard-profile-picture-input-2">
          <button>Add Profile Picture</button>
        </form>
        <% } %>
      </div>
    </div>

    <div id="viewer-dashboard-div-wrapper">
      <!-- Balance -->
      <div class="viewers-dashboard-card">
        <div class="viewers-dashboard-card-header">
          <div class="viewers-dashboard-card-title">Balance</div>
        </div>
        <div class="viewers-dashboard-card-value">
          â‚¹<%= user.balance?.toFixed(2) || '0.00' %>
        </div>
        <!-- ADD THIS BUTTON -->
        <button id="buy-credits-btn" class="viewers-dashboard-button">Buy Credits</button>
      </div>

      <!-- Email -->
      <div class="viewers-dashboard-card">
        <div class="viewers-dashboard-card-header">
          <div class="viewers-dashboard-card-title">Email</div>
        </div>
        <div class="viewers-dashboard-card-value"><%= user.email %></div>
      </div>

    </div>
    <!-- Status -->
    <div class="viewers-dashboard-card">
      <div class="viewers-dashboard-card-header">
        <div class="viewers-dashboard-card-title">Status</div>
      </div>
      <div class="viewers-dashboard-card-value " id="viewers-dashboard-status-card">
        <span class="viewers-dashboard-status-badge <%= user.status === 'active' ? 'viewers-dashboard-status-active' : 'viewers-dashboard-status-retired' %>">
          <%= user.status %>
        </span>
      </div>
      <form id="viewers-dashboard-status-form" class="viewers-dashboard-form" action="/dashboard/viewer/status" method="post">
        <input type="hidden" name="status" value="<%= user.status %>">
        <button id="viewers-dashboard-status-button" class="viewers-dashboard-button">Change</button>
      </form>
    </div>
  </div>

  <!-- Favorite Teams Section -->
  <div class="viewers-dashboard-section">
    <div class="viewers-dashboard-section-header">
      <h3 class="viewers-dashboard-section-title">Favorite Teams</h3>
    </div>

    <% if (user.favorite_teams.length > 0) { %>
    <div class="viewers-dashboard-merchandise-grid">
      <% user.favorite_teams.forEach(team => { %>
      <div class="viewers-dashboard-merchandise-card">
        <div class="viewers-dashboard-merchandise-image">
          <% if (team.logo) { %>
          <img src="<%= team.logo %>" alt="<%= team.name %>" style="width: 100%; height: 100%; object-fit: cover;">
          <% } else { %>
          <img src="/images/avatar.png" alt="<%= team.name %>" style="width: 100%; height: 100%; object-fit: cover;">
          <% } %>
        </div>
        <div class="viewers-dashboard-merchandise-info">
          <div class="viewers-dashboard-merchandise-title">
            <a href="/clubs/list/<%= team._id %>"><%= team.name %></a>
          </div>
          <div class="viewers-dashboard-merchandise-category">
            <%= team.sport || 'Sport' %>
          </div>
        </div>
      </div>
      <% }) %>
    </div>
    <% } else { %>
    <p>No favorite teams added yet.</p>
    <% } %>

    <!-- Add/Remove Club Buttons -->
    <button class="viewers-dashboard-fav-add">Add New Fav Club</button>
    <button class="viewers-dashboard-fav-remove-trigger">Remove Fav Club</button>

    <!-- Add/Remove Club Forms -->
    <div id="viewers-dashboard-form-grouping">
      <!-- Add Favorite Team Form -->
      <form class="viewers-dashboard-fav-add-form" id="viewers-dashboard-fav-add-form" action="/dashboard/viewer/add_fav_club" method="post">
        <label for="viewers-dashboard-fav-add-select" class="viewers-dashboard-label">Select Club to Add it to Favourite:</label>
        <select name="favorite_teams" id="viewers-dashboard-fav-add-select" class="viewers-dashboard-select">
          <option disabled selected>--select--</option>
          <% refinedclubs.forEach(club => { %>
          <option value="<%= club._id %>"><%= club.name %></option>
          <% }) %>
        </select>
        <button type="submit" class="viewers-dashboard-add-button">Add Club</button>
      </form>

      <!-- Remove Favorite Team Form -->
      <form class="viewers-dashboard-fav-remove-form" id="viewers-dashboard-fav-remove-form" action="/dashboard/viewer/remove_fav_club" method="post">
        <label for="viewers-dashboard-fav-remove-select" class="viewers-dashboard-label">Select Favorite Club to Remove:</label>
        <select name="favorite_teams" id="viewers-dashboard-fav-remove-select" class="viewers-dashboard-select">
          <option disabled selected>--select--</option>
          <% user.favorite_teams.forEach(club => { %>
          <option value="<%= club._id %>"><%= club.name %></option>
          <% }) %>
        </select>
        <button type="submit" class="viewers-dashboard-remove-button">Remove Club</button>
      </form>
    </div>
  </div>

<!-- Shipping Address -->
 <div class="viewers-dashboard-section">
      <div class="viewers-dashboard-section-header">
          <h3 class="viewers-dashboard-section-title">Shipping Address</h3>
      </div>

      <!-- This table will display the current address, matching the Account Info style -->
      <table class="viewers-dashboard-table" id="address-display-view">
          <% if (user.address && user.address.street) { %>
              <tr>
                  <th>Address</th>
                  <td>
                      <%= user.address.street %><br>
                      <%= user.address.city %>, <%= user.address.state %> - <%= user.address.postalCode %><br>
                      <%= user.address.country %>
                  </td>
              </tr>
          <% } else { %>
              <tr>
                  <td colspan="2">No shipping address on file. Please add one for merchandise delivery.</td>
              </tr>
          <% } %>
      </table>

      <button id="edit-address-btn" class="viewers-dashboard-button">
          <%= (user.address && user.address.street) ? 'Update Address' : 'Add Address' %>
      </button>

      <!-- This is the hidden form for adding/editing the address -->
      <form id="address-form" action="/dashboard/viewer/update_address" method="POST" style="display: none;">
          <div class="viewers-dashboard-form-group">
              <label for="street">Street Address</label>
              <input type="text" id="street" name="street" class="viewers-dashboard-form-control" value="<%= user.address?.street || '' %>" required>
          </div>
          <div class="viewers-dashboard-form-group">
              <label for="city">City</label>
              <input type="text" id="city" name="city" class="viewers-dashboard-form-control" value="<%= user.address?.city || '' %>" required>
          </div>
          <div class="viewers-dashboard-form-group">
              <label for="state">State</label>
              <input type="text" id="state" name="state" class="viewers-dashboard-form-control" value="<%= user.address?.state || '' %>" required>
          </div>
          <div class="viewers-dashboard-form-group">
              <label for="postalCode">Postal Code</label>
              <input type="text" id="postalCode" name="postalCode" class="viewers-dashboard-form-control" value="<%= user.address?.postalCode || '' %>" required>
          </div>
          <button type="submit" class="viewers-dashboard-button">Save Address</button>
      </form>
  </div>
  
  <!-- Account Info Section -->
  <div class="viewers-dashboard-section">
    <div class="viewers-dashboard-section-header">
      <h3 class="viewers-dashboard-section-title">Account Info</h3>
    </div>
    <table class="viewers-dashboard-table">
      <tr>
        <th>User Type</th>
        <td><%= user.user_type %></td>
      </tr>
      <tr>
        <th>Created At</th>
        <td><%= new Date(user.createdAt).toLocaleDateString() %></td>
      </tr>
      <tr>
        <th>Last Updated</th>
        <td><%= new Date(user.updatedAt).toLocaleDateString() %></td>
      </tr>
    </table>
  </div>

 

<div id="buy-credits-modal" class="viewers-dashboard-modal-overlay" style="display: none;">
    <div class="viewers-dashboard-modal-content">
        <span class="viewers-dashboard-close-modal close-modal">&times;</span>
        <h2 class="viewers-dashboard-modal-title">Buy Credits</h2>
        <p class="viewers-dashboard-modal-description">Enter the amount you wish to add to your balance.</p>
        
        <form id="buy-credits-form" class="viewers-dashboard-modal-form">
            <div class="viewers-dashboard-form-group">
                <label for="amount" class="viewers-dashboard-form-label">Amount (â‚¹)</label>
                <input type="number" id="amount" name="amount" min="100" step="50" placeholder="e.g., 500" required class="viewers-dashboard-form-control">
            </div>
            <button type="submit" id="razorpay-btn" class="viewers-dashboard-modal-button">Proceed to Pay</button>
        </form>
    </div>
</div>

<!-- The Razorpay Script (must be included on this page) --> Â 
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="/script/viewer_dashboard.js"></script>

<!-- Add these styles to your viewers_dashboard.css file or in a <style> tag -->
<!-- <style>
    .address-section {
        background-color: var(--bg-dark-secondary, #1E1E1E);
        padding: 2rem;
        border-radius: 12px;
        border: 1px solid var(--border-color, #2F2F2F);
        margin-top: 2rem;
    }

    #address-display-view p {
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--text-secondary, #A0A0A0);
        margin-bottom: 1.5rem;
        background-color: var(--bg-dark-primary, #121212);
        padding: 1rem;
        border-radius: 8px;
        border-left: 4px solid var(--accent-primary, #FF4C30);
    }

    #address-form {
        display: grid;
        gap: 1rem;
        margin-top: 1.5rem;
    }

    .viewers-dashboard-form-group label {
        display: block;
        font-weight: 500;
        color: var(--text-secondary, #A0A0A0);
        margin-bottom: 0.5rem;
    }

    .viewers-dashboard-form-control {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--border-color, #2F2F2F);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background-color: var(--bg-dark-primary, #121212);
      color: var(--text-primary, #EAEAEA);
    }

    .viewers-dashboard-form-control:focus {
      outline: none;
      border-color: var(--accent-primary, #FF4C30);
      box-shadow: 0 0 0 3px rgba(255, 76, 48, 0.2);
    }

    .viewers-dashboard-button {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid var(--accent-primary, #FF4C30);
        background-color: var(--accent-primary, #FF4C30);
        color: #fff;
    }

    .viewers-dashboard-button:hover {
        background-color: transparent;
        color: var(--accent-primary, #FF4C30);
    }
</style> -->
